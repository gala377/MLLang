
extend seq {
  fn find s pred:
    let res = filter s pred
    if seq.empty? res:
      none
    else:
      fst res,

  fn empty? s = eq? (seq.len s) 0,

  fn notempty? s = not (seq.empty? s),

  ; needs to be anonymous so it does not requrse on itself
  ; when calling eq? from prelude
  eq?: do a b:
    if not (eq? (seq.len a) (seq.len b)):
      false
    else:
      fold (zip a b) true do |acc v|:
        if not acc:
          false
        else:
          eq? (fst v) (snd v)
}